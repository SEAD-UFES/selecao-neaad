
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(window.jQuery||window.Zepto)}}(function(a){var b=function(g,d,f){var h=this,e,c;g=a(g);d=typeof d==="function"?d(g.val(),undefined,g,f):d;h.init=function(){f=f||{};h.byPassKeys=[9,16,17,18,36,37,38,39,40,91];h.translation={"0":{pattern:/\d/},"9":{pattern:/\d/,optional:true},"#":{pattern:/\d/,recursive:true},A:{pattern:/[a-zA-Z0-9]/},S:{pattern:/[a-zA-Z]/}};h.translation=a.extend({},h.translation,f.translation);h=a.extend(true,{},h,f);c=i.getRegexMask();g.each(function(){if(f.maxlength!==false){g.attr("maxlength",d.length)}if(f.placeholder){g.attr("placeholder",f.placeholder)}g.attr("autocomplete","off");i.destroyEvents();i.events();var j=i.getCaret();i.val(i.getMasked());i.setCaret(j+i.getMaskCharactersBeforeCount(j,true))})};var i={getCaret:function(){var l,n=0,k=g.get(0),j=document.selection,m=k.selectionStart;if(j&&!~navigator.appVersion.indexOf("MSIE 10")){l=j.createRange();l.moveStart("character",g.is("input")?-g.val().length:-g.text().length);n=l.text.length}else{if(m||m==="0"){n=m}}return n},setCaret:function(l){if(g.is(":focus")){var j,k=g.get(0);if(k.setSelectionRange){k.setSelectionRange(l,l)}else{if(k.createTextRange){j=k.createTextRange();j.collapse(true);j.moveEnd("character",l);j.moveStart("character",l);j.select()}}}},events:function(){g.on("keydown.mask",function(){e=i.val()});g.on("keyup.mask",i.behaviour);g.on("paste.mask drop.mask",function(){setTimeout(function(){g.keydown().keyup()},100)});g.on("change.mask",function(){g.data("changeCalled",true)});g.on("blur.mask",function(k){var j=a(k.target);if(j.prop("defaultValue")!==j.val()){j.prop("defaultValue",j.val());if(!j.data("changeCalled")){j.trigger("change")}}j.data("changeCalled",false)});g.on("focusout.mask",function(){if(f.clearIfNotMatch&&!c.test(i.val())){i.val("")}})},getRegexMask:function(){var l=[],q,p,k,j,o,n;for(var m=0;m<d.length;m++){q=h.translation[d[m]];if(q){p=q.pattern.toString().replace(/.{1}$|^.{1}/g,"");k=q.optional;j=q.recursive;if(j){l.push(d[m]);o={digit:d[m],pattern:p}}else{l.push((!k&&!j)?p:(p+"?"))}}else{l.push("\\"+d[m])}}n=l.join("");if(o){n=n.replace(new RegExp("("+o.digit+"(.*"+o.digit+")?)"),"($1)?").replace(new RegExp(o.digit,"g"),o.pattern)}return new RegExp(n)},destroyEvents:function(){g.off("keydown.mask keyup.mask paste.mask drop.mask change.mask blur.mask focusout.mask").removeData("changeCalled")},val:function(j){var k=g.is("input");return arguments.length>0?(k?g.val(j):g.text(j)):(k?g.val():g.text())},getMaskCharactersBeforeCount:function(k,j){for(var m=0,l=0,n=d.length;l<n&&l<k;l++){if(!h.translation[d.charAt(l)]){k=j?k+1:k;m++}}return m},determineCaretPos:function(n,j,k,m){var l=h.translation[d.charAt(Math.min(n-1,d.length-1))];return !l?i.determineCaretPos(n+1,j,k,m):Math.min(n+k-j-m,k)},behaviour:function(n){n=n||window.event;var q=n.keyCode||n.which;if(a.inArray(q,h.byPassKeys)===-1){var m=i.getCaret(),k=i.val(),o=k.length,l=m<o,j=i.getMasked(),r=j.length,p=i.getMaskCharactersBeforeCount(r-1)-i.getMaskCharactersBeforeCount(o-1);if(j!==k){i.val(j)}if(l&&!(q===65&&n.ctrlKey)){if(!(q===8||q===46)){m=i.determineCaretPos(m,o,r,p)}i.setCaret(m)}return i.callbacks(n)}},getMasked:function(x){var o=[],y=i.val(),q=0,u=d.length,z=0,n=y.length,t=1,s="push",p=-1,A,l;if(f.reverse){s="unshift";t=-1;A=0;q=u-1;z=n-1;l=function(){return q>-1&&z>-1}}else{A=u-1;l=function(){return q<u&&z<n}}while(l()){var r=d.charAt(q),k=y.charAt(z),j=h.translation[r];if(j){if(k.match(j.pattern)){o[s](k);if(j.recursive){if(p===-1){p=q}else{if(q===A){q=p-t}}if(A===p){q-=t}}q+=t}else{if(j.optional){q+=t;z-=t}}z+=t}else{if(!x){o[s](r)}if(k===r){z+=t}q+=t}}var w=d.charAt(A);if(u===n+1&&!h.translation[w]){o.push(w)}return o.join("")},callbacks:function(j){var l=i.val(),k=i.val()!==e;if(k===true){if(typeof f.onChange==="function"){f.onChange(l,j,g,f)}}if(k===true&&typeof f.onKeyPress==="function"){f.onKeyPress(l,j,g,f)}if(typeof f.onComplete==="function"&&l.length===d.length){f.onComplete(l,j,g,f)}}};h.remove=function(){var k=i.getCaret(),j=i.getMaskCharactersBeforeCount(k);i.destroyEvents();i.val(h.getCleanVal()).removeAttr("maxlength");i.setCaret(k-j)};h.getCleanVal=function(){return i.getMasked(true)};h.init()};a.fn.mask=function(c,d){this.unmask();return this.each(function(){a(this).data("mask",new b(this,c,d))})};a.fn.unmask=function(){return this.each(function(){try{a(this).data("mask").remove()}catch(c){}})};a.fn.cleanVal=function(){return a(this).data("mask").getCleanVal()};a("*[data-mask]").each(function(){var c=a(this),d={},e="data-mask-";if(c.attr(e+"reverse")==="true"){d.reverse=true}if(c.attr(e+"maxlength")==="false"){d.maxlength=false}if(c.attr(e+"clearifnotmatch")==="true"){d.clearIfNotMatch=true}c.mask(c.attr("data-mask"),d)})}));